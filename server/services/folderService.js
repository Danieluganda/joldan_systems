/**\n * Folder Service\n * \n * Manage document folder hierarchy and organization\n * Feature 10: Document management\n */\n\nconst logger = require('../utils/logger');\n\nclass FolderService {\n  /**\n   * Folder structure in document storage\n   * Format: procurements/{procurementId}/{entityType}/{entityId}/\n   */\n\n  /**\n   * Generate folder path for entity\n   */\n  static generateFolderPath(entityType, entityId, procurementId) {\n    return `procurements/${procurementId}/${entityType}/${entityId}`;\n  }\n\n  /**\n   * Generate folder structure for procurement\n   */\n  static generateProcurementFolderStructure(procurementId) {\n    return {\n      root: `procurements/${procurementId}`,\n      planning: `procurements/${procurementId}/plans`,\n      rfq: `procurements/${procurementId}/rfqs`,\n      submissions: `procurements/${procurementId}/submissions`,\n      evaluations: `procurements/${procurementId}/evaluations`,\n      approvals: `procurements/${procurementId}/approvals`,\n      awards: `procurements/${procurementId}/awards`,\n      contracts: `procurements/${procurementId}/contracts`,\n      documents: `procurements/${procurementId}/documents`,\n    };\n  }\n\n  /**\n   * Organize documents by type\n   */\n  static organizeFoldersByDocumentType(procurementId) {\n    return {\n      specifications: `procurements/${procurementId}/documents/specifications`,\n      termsConditions: `procurements/${procurementId}/documents/terms_conditions`,\n      evaluationCriteria: `procurements/${procurementId}/documents/evaluation_criteria`,\n      tenderDocument: `procurements/${procurementId}/documents/tender`,\n      submissions: `procurements/${procurementId}/documents/submissions`,\n      evaluationReports: `procurements/${procurementId}/documents/evaluation_reports`,\n      awardNotice: `procurements/${procurementId}/documents/award_notice`,\n      contracts: `procurements/${procurementId}/documents/contracts`,\n    };\n  }\n\n  /**\n   * Get folder metadata\n   */\n  static getFolderMetadata(entityType, entityId, procurementId) {\n    return {\n      path: this.generateFolderPath(entityType, entityId, procurementId),\n      entityType,\n      entityId,\n      procurementId,\n      createdAt: new Date(),\n      files: [],\n      subfolders: [],\n    };\n  }\n\n  /**\n   * Build complete folder tree for procurement\n   */\n  static buildFolderTree(procurementId) {\n    try {\n      const structure = this.generateProcurementFolderStructure(procurementId);\n      const documentTypes = this.organizeFoldersByDocumentType(procurementId);\n\n      return {\n        procurementId,\n        rootPath: `procurements/${procurementId}`,\n        folders: {\n          workflow: structure,\n          documents: documentTypes,\n        },\n        createdAt: new Date(),\n      };\n    } catch (error) {\n      logger.error('Error building folder tree', { error: error.message });\n      throw error;\n    }\n  }\n\n  /**\n   * Validate folder path\n   */\n  static validateFolderPath(path) {\n    // Check for directory traversal attempts\n    if (path.includes('..') || path.startsWith('/')) {\n      return false;\n    }\n    return true;\n  }\n\n  /**\n   * Get folder statistics\n   */\n  static getFolderStats(folderPath) {\n    return {\n      path: folderPath,\n      fileCount: 0,\n      totalSize: 0,\n      lastModified: new Date(),\n    };\n  }\n}\n\nmodule.exports = FolderService;\n"
