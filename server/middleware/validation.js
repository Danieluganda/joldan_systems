/**\n * Validation Middleware\n * \n * Request body and query parameter validation\n */\n\nconst { validateObject } = require('../shared/validation-rules');\nconst logger = require('../utils/logger');\n\n/**\n * Validate request body against schema\n */\nconst validateBody = (schema) => {\n  return (req, res, next) => {\n    const { valid, errors } = validateObject(req.body, schema);\n\n    if (!valid) {\n      logger.warn('Validation error', {\n        errors,\n        body: req.body,\n        url: req.originalUrl,\n      });\n      return res.status(400).json({\n        success: false,\n        message: 'Validation Error',\n        errors,\n      });\n    }\n\n    next();\n  };\n};\n\n/**\n * Validate request query parameters\n */\nconst validateQuery = (schema) => {\n  return (req, res, next) => {\n    const { valid, errors } = validateObject(req.query, schema);\n\n    if (!valid) {\n      logger.warn('Query validation error', {\n        errors,\n        query: req.query,\n        url: req.originalUrl,\n      });\n      return res.status(400).json({\n        success: false,\n        message: 'Query Validation Error',\n        errors,\n      });\n    }\n\n    next();\n  };\n};\n\n/**\n * Validate request params\n */\nconst validateParams = (schema) => {\n  return (req, res, next) => {\n    const { valid, errors } = validateObject(req.params, schema);\n\n    if (!valid) {\n      logger.warn('Params validation error', {\n        errors,\n        params: req.params,\n        url: req.originalUrl,\n      });\n      return res.status(400).json({\n        success: false,\n        message: 'Params Validation Error',\n        errors,\n      });\n    }\n\n    next();\n  };\n};\n\n/**\n * Sanitize input data\n */\nconst sanitize = (req, res, next) => {\n  if (req.body) {\n    Object.keys(req.body).forEach((key) => {\n      if (typeof req.body[key] === 'string') {\n        // Remove leading/trailing whitespace\n        req.body[key] = req.body[key].trim();\n      }\n    });\n  }\n\n  next();\n};\n\nmodule.exports = {\n  validateBody,\n  validateQuery,\n  validateParams,\n  sanitize,\n};\n"
